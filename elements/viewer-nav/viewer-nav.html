<link rel="import"
      href="../../bower_components/polymer/polymer.html">

<dom-module id="viewer-nav">
  <template>
    <section class="filter">
    <span class="select-field protocol">
        <label for="select-domain">Protocol Domain</label>

        <select id="select-domain" on-change="selectDomain">
          <option value="-1">Select domain</option>
          <template is="dom-repeat" items="{{protocol.domainNames}}" as="domainName">
            <option value="{{index}}">{{domainName}}</option>
          </template>
        </select>
    </span>

    <span class="select-field method">
      <label for="select-method">Method</label>
      <select id="select-method" on-change="selectMethod">
        <option value="-1">Show all methods</option>
        <template is="dom-repeat" items="{{selectedDomain.methodNames}}" as="methodName">
          <option value="{{index}}">{{methodName}}</option>
        </template>
      </select>
    </span>

    <span class="select-field events">
      <label for="select-events">Events</label>
      <select id="select-events" on-change="selectEvent">
        <option value="-1">Show all events</option>
        <template is="dom-repeat" items="{{selectedDomain.eventNames}}" as="eventName">
          <option value="{{index}}">{{eventName}}</option>
        </template>
      </select>
    </span>
    </section>
  </template>
  <script>
    Polymer({
      is: 'viewer-nav',
      properties: {
        protocol: Object
      },
      selectDomain: function (event) {
        this.resetEvent();
        this.resetMethod();

        var domainName = this.protocol.domainNames[event.target.value];
        this.selectedDomain = this.protocol[domainName];
        this.fire('domain-changed', {
          domain: this.selectedDomain
        });
      },
      resetMethod: function () {
        this.$['select-method'].value = -1;
      },
      resetEvent: function () {
        this.$['select-events'].value = -1;
      },
      selectMethod: function (event) {
        this.resetEvent();

        var selectedMethod = this.selectedDomain.methods[event.target.value];
        this.fire('method-changed', {
          method: selectedMethod
        });
      },
      selectEvent: function (event) {
        this.resetMethod();

        var selectedEvent = this.selectedDomain.events[event.target.value];
        this.fire('event-changed', {
          event: selectedEvent
        });
      }
    });
  </script>
</dom-module>
